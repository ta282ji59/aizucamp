<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.createjs.com/1.0.0/createjs.min.js"></script>
    <title>Document</title>
</head>

<body>
    <canvas id="myCanvas" width="900" height="540" style="cursor: none;"></canvas>
    <script>
        window.addEventListener("load", init);
        function init() {
            let stage = new createjs.Stage("myCanvas");
            let enemyCount = 0;
            let enemyList = [];
            let timer = 0;  // Add this line for the timer

            // let bg = new createjs.Bitmap("https://cdn.openbloc.fr/2018/04/DRrHqFUW0AAlYcT.jpg-large.jpeg");
            let bg = new createjs.Shape();
            bg.graphics.beginFill("aqua").drawRect(0, 0, 900, 540);
            stage.addChild(bg);

            let player = new createjs.Shape();
            player.graphics.setStrokeStyle(2)
                .beginStroke("blue")
                .drawCircle(0, 0, 20)
                .moveTo(0, -30)
                .lineTo(0, 30)
                .moveTo(-30, 0)
                .lineTo(30, 0);
            stage.addChild(player);

            // Timer display setup
            let timerDisplay = new createjs.Text("Timer: 0s", "20px Arial", "black");
            timerDisplay.x = 750;  // Adjust position based on the canvas size and desired position
            timerDisplay.y = 10;
            stage.addChild(timerDisplay);

            createjs.Ticker.setFPS(60);
            createjs.Ticker.addEventListener("tick", handleTick);

            function handleTick() {
                player.x = stage.mouseX;
                player.y = stage.mouseY;

                // Timer increment and display update
                timer += 1 / 60;  // Increment timer by 1/60th of a second on each tick
                timerDisplay.text = "Timer: " + timer.toFixed(1) + "s";
                
                if (enemyCount % 100 === 0) {
                    let enemy = new createjs.Bitmap("image/enemy.png");
                    enemy.scaleX = 0.08;
                    enemy.scaleY = 0.08;
                    
                    enemy.x = 900 * Math.random();
                    enemy.y = 540 * Math.random();

                    // 敵がクリックされたときのイベントリスナを追加
                    enemy.addEventListener('click', function (event) {
                        // クリックされた敵をステージから削除
                        stage.removeChild(event.currentTarget);

                        // 敵をenemyListからも削除
                        let index = enemyList.indexOf(event.currentTarget);
                        if (index !== -1) {
                            enemyList.splice(index, 1);
                        }
                    });

                    stage.addChild(enemy);
                    enemyList.push(enemy);
                    stage.setChildIndex(player, stage.getNumChildren() - 1);
                }
                enemyCount++;

                


                for (let i = 0; i < enemyList.length; i++) {
                    enemyList[i].x += 1 * Math.random();
                    enemyList[i].y += 1 * Math.random();
                    enemyList[i].x -= 1 * Math.random();
                    enemyList[i].y -= 1 * Math.random();
                }
                
                stage.update();
            }
        }



    </script>
</body>

</html>