<!DOCTYPE html>
<html lang="en">


<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <script src="https://code.createjs.com/1.0.0/createjs.min.js"></script>
   <title>Document</title>
</head>


<body>
   <canvas id="myCanvas" width="900" height="540" style="cursor: none;"></canvas>
   <script>


       window.addEventListener("load", init);
       createjs.Sound.on("fileload", soundLoaded);
       createjs.Sound.registerSound("music/startmusic.mp3", "startbgm");
       createjs.Sound.registerSound("music/BGM1.mp3", "BGM1");
       createjs.Sound.registerSound("music/BGM2.mp3", "BGM2");
       createjs.Sound.registerSound("music/gun1.mp3", "gun1");


       function soundLoaded(event) {
           // Handle what you want to do once the sound is loaded.
           // For now, we'll do nothing.
       }


       function playSound1() {
           createjs.Sound.play("startbgm");
       }
       function playSound2() {
           createjs.Sound.play("BGM1");
       }
       function playSound3() {
           createjs.Sound.play("BGM2");
       }
       function playSound4() {
           createjs.Sound.play("gun1");
       }


       playsound1()


       function init() {
           let stage = new createjs.Stage("myCanvas");
           let enemyCount = 0;
           let enemyList = [];
           let scene = 0
           let timer = 5;  // タイマーのスタート:BGM都合で100以下
           let scores = 0 //スコア定義0






           let bg = new createjs.Bitmap("image/oki.png");
           let bg2List = ["un.jpg", "ai.png"]
           let bg2 = new createjs.Bitmap("image/" + bg2List[Math.floor(Math.random() * 2)])
           let bg3 = new createjs.Bitmap("image/result.png")
           stage.addChild(bg3);
           stage.addChild(bg2);
           stage.addChild(bg);


           let wg = new createjs.Shape()
           wg.graphics.beginFill("white").drawRect(745, 5, 130, 30)//(0,0)〜(960,540)までを黒い画面にする
           stage.addChild(wg)


           let player = new createjs.Shape();//エイムを作る
           player.graphics.setStrokeStyle(2)
               .beginStroke("blue")
               .drawCircle(0, 0, 40)
               .moveTo(0, -50)
               .lineTo(0, 50)
               .moveTo(-50, 0)
               .lineTo(50, 0);
           stage.addChild(player);




           // Timer display setup
           let timerDisplay = new createjs.Text("Timer: ", "20px Arial", "black");
           timerDisplay.x = 750;  // Adjust position based on the canvas size and desired position
           timerDisplay.y = 10;
           stage.addChild(timerDisplay);


           if (scene === 0) {
               playSound()
           }








           stage.addEventListener("click", handleClick)//クリックした際、handleClick関数を実行


           createjs.Ticker.setFPS(60);
           createjs.Ticker.addEventListener("tick", handleTick);


           function handleClick() {//scene=0はタイトル画面、1はゲーム画面を表す。
               if (scene === 0) {
                   scene = 1;
                   stage.removeChild(bg)
               }
               else if (scene === 1) { }
               else if (scene === 2) { }
           }


           function handleTick() {
               if (scene === 0) {
                   stage.update()
               }
               else if (scene === 1) {
                   player.x = stage.mouseX;
                   player.y = stage.mouseY;






                   if (timer <= 0) {
                       Finish();
                   }


                   // Timer increment and display update
                   timer -= 1 / 60;  // Increment timer by 1/60th of a second on each tick
                   timerDisplay.text = "Timer: " + timer.toFixed(1) + "s";




                   // scoreDisplay.text = scores;


                   if (enemyCount % 50 === 0 || enemyCount === 0 || enemyCount === 1 || enemyCount === 2) {
                       let enemyImageList = ["image/忍者雲.png", "image/忍者.png", "image/luffy.png"]
                       let enemy = new createjs.Bitmap(enemyImageList[Math.floor(Math.random() * 3)])


                       enemy.scaleX = 0.08;
                       enemy.scaleY = 0.08;


                       enemy.x = 900 * Math.random();
                       enemy.y = 540 * Math.random();




                       // 敵がクリックされたときのイベントリスナを追加
                       enemy.addEventListener('click', function (event) {
                           // クリックされた敵をステージから削除
                           stage.removeChild(event.currentTarget);
                           scores++
                           playSound4();
                           // 敵をenemyListからも削除
                           let index = enemyList.indexOf(event.currentTarget);
                           if (index !== -1) {
                               enemyList.splice(index, 1);
                           }


                       });


                       stage.addChild(enemy);
                       enemyList.push(enemy);


                       // stage.setChildIndex(enemy, 1);


                   }
                   enemyCount++;


                   // for (let i = 0; i < enemyList.length; i++) {
                   //     enemyList[i].x += 1 * Math.random();
                   //     enemyList[i].y += 1 * Math.random();
                   //     enemyList[i].x -= 1 * Math.random();
                   //     enemyList[i].y -= 1 * Math.random();
                   // }


                   // stage.setChildIndex(player, stage.getNumChildren() - 1);
                   stage.update();
               }
           }
           function Finish() {
               scene = 2
               stage.removeChild(bg2)
               stage.setChildIndex(bg3, stage.getNumChildren() - 1);
               let scoreDisplay = new createjs.Text(scores, "65px Arial", "red")
               scoreDisplay.x = 550//最終スコア表示座標
               scoreDisplay.y = 370
               stage.addChild(scoreDisplay)
           }
       }
       function playSound() {
           createjs.Sound.play("startbgm")
       }




   </script>
</body>


</html>
<!DOCTYPE html>
<html lang="en">


<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <script src="https://code.createjs.com/1.0.0/createjs.min.js"></script>
   <title>Document</title>
</head>


<body>
   <canvas id="myCanvas" width="900" height="540" style="cursor: none;"></canvas>
   <script>


       window.addEventListener("load", init);
       createjs.Sound.on("fileload", soundLoaded);
       createjs.Sound.registerSound("music/startmusic.mp3", "startbgm");
       createjs.Sound.registerSound("music/BGM1.mp3", "BGM1");
       createjs.Sound.registerSound("music/BGM2.mp3", "BGM2");
       createjs.Sound.registerSound("music/gun1.mp3", "gun1");


       function soundLoaded(event) {
           // Handle what you want to do once the sound is loaded.
           // For now, we'll do nothing.
       }


       function playSound1() {
           createjs.Sound.play("startbgm");
       }
       function playSound2() {
           createjs.Sound.play("BGM1");
       }
       function playSound3() {
           createjs.Sound.play("BGM2");
       }
       function playSound4() {
           createjs.Sound.play("gun1");
       }


       playsound1()


       function init() {
           let stage = new createjs.Stage("myCanvas");
           let enemyCount = 0;
           let enemyList = [];
           let scene = 0
           let timer = 5;  // タイマーのスタート:BGM都合で100以下
           let scores = 0 //スコア定義0






           let bg = new createjs.Bitmap("image/oki.png");
           let bg2List = ["un.jpg", "ai.png"]
           let bg2 = new createjs.Bitmap("image/" + bg2List[Math.floor(Math.random() * 2)])
           let bg3 = new createjs.Bitmap("image/result.png")
           stage.addChild(bg3);
           stage.addChild(bg2);
           stage.addChild(bg);


           let wg = new createjs.Shape()
           wg.graphics.beginFill("white").drawRect(745, 5, 130, 30)//(0,0)〜(960,540)までを黒い画面にする
           stage.addChild(wg)


           let player = new createjs.Shape();//エイムを作る
           player.graphics.setStrokeStyle(2)
               .beginStroke("blue")
               .drawCircle(0, 0, 40)
               .moveTo(0, -50)
               .lineTo(0, 50)
               .moveTo(-50, 0)
               .lineTo(50, 0);
           stage.addChild(player);




           // Timer display setup
           let timerDisplay = new createjs.Text("Timer: ", "20px Arial", "black");
           timerDisplay.x = 750;  // Adjust position based on the canvas size and desired position
           timerDisplay.y = 10;
           stage.addChild(timerDisplay);


           if (scene === 0) {
               playSound()
           }








           stage.addEventListener("click", handleClick)//クリックした際、handleClick関数を実行


           createjs.Ticker.setFPS(60);
           createjs.Ticker.addEventListener("tick", handleTick);


           function handleClick() {//scene=0はタイトル画面、1はゲーム画面を表す。
               if (scene === 0) {
                   scene = 1;
                   stage.removeChild(bg)
               }
               else if (scene === 1) { }
               else if (scene === 2) { }
           }


           function handleTick() {
               if (scene === 0) {
                   stage.update()
               }
               else if (scene === 1) {
                   player.x = stage.mouseX;
                   player.y = stage.mouseY;






                   if (timer <= 0) {
                       Finish();
                   }


                   // Timer increment and display update
                   timer -= 1 / 60;  // Increment timer by 1/60th of a second on each tick
                   timerDisplay.text = "Timer: " + timer.toFixed(1) + "s";



                   if (enemyCount % 50 === 0 || enemyCount === 0 || enemyCount === 1 || enemyCount === 2) {
                       let enemyImageList = ["image/忍者雲.png", "image/忍者.png", "image/luffy.png"]
                       let enemy = new createjs.Bitmap(enemyImageList[Math.floor(Math.random() * 3)])


                       enemy.scaleX = 0.08;
                       enemy.scaleY = 0.08;


                       enemy.x = 900 * Math.random();
                       enemy.y = 540 * Math.random();




                       // 敵がクリックされたときのイベントリスナを追加
                       enemy.addEventListener('click', function (event) {
                           // クリックされた敵をステージから削除
                           stage.removeChild(event.currentTarget);
                           scores++
                           playSound4();
                           // 敵をenemyListからも削除
                           let index = enemyList.indexOf(event.currentTarget);
                           if (index !== -1) {
                               enemyList.splice(index, 1);
                           }
                       });


                       stage.addChild(enemy);
                       enemyList.push(enemy);


                       // stage.setChildIndex(enemy, 1);


                   }
                   enemyCount++;


                   // for (let i = 0; i < enemyList.length; i++) {
                   //     enemyList[i].x += 1 * Math.random();
                   //     enemyList[i].y += 1 * Math.random();
                   //     enemyList[i].x -= 1 * Math.random();
                   //     enemyList[i].y -= 1 * Math.random();
                   // }


                   // stage.setChildIndex(player, stage.getNumChildren() - 1);
                   stage.update();
               }
           }
           function Finish() {
               scene = 2
               stage.removeChild(bg2)
               stage.setChildIndex(bg3, stage.getNumChildren() - 1);
               let scoreDisplay = new createjs.Text(scores, "65px Arial", "red")
               scoreDisplay.x = 550//最終スコア表示座標
               scoreDisplay.y = 370
               stage.addChild(scoreDisplay)
           }
       }
       function playSound() {
           createjs.Sound.play("startbgm")
       }




   </script>
</body>


</html>


